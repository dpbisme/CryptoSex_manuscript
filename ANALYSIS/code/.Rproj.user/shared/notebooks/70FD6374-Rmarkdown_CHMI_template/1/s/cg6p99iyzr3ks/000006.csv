"0","# setting up model matrix without an intercept"
"0","design2 <- model.matrix(~0 + group[13:21, drop = TRUE])"
"0","colnames(design2) <- levels(group[13:21, drop = TRUE])"
"0","# using VOOM function from Limma package to apply precision weights to each gene"
"0","v.myDGEList.filtered.norm2 <- voom(myDGEList.filtered.norm2, design2, plot = FALSE)"
"0","fit2 <- lmFit(v.myDGEList.filtered.norm2, design2)"
"0","# setting up contrast matrix for two main pairwise comparisons"
"0","contrast.matrix2 <- makeContrasts(sexualDevelop = sexual_invitro - asexual_invitro,"
"0","                                 asexualGrowth = asexual_invitro - sporozoite_invivo,"
"0","                                 levels=design2)"
"0","fits2 <- contrasts.fit(fit2, contrast.matrix2)"
"0","# extracting stats "
"0","ebFit2 <- eBayes(fits2)"
"0","# listing stats for all genes in the dataset to be used for making volcano plot"
"0","myTopHits2 <- topTable(ebFit2, adjust =""BH"", coef=1, number=10000, sort.by=""logFC"")"
"0","myTopHits2 <- as_tibble(myTopHits2, rownames = ""geneSymbol"")"
"0","# volcano plot"
"0","ggplot(myTopHits2, aes(y=-log10(adj.P.Val), x=logFC, text = paste(""Symbol:"", geneSymbol))) +"
"0","  geom_point(size=2) +"
"0","  ylim(-0.5,15) +"
"0","  xlim(-15,15) +"
"0","  geom_hline(yintercept = -log10(0.01), linetype=""longdash"", colour=""grey"", size=1) +"
"0","  geom_vline(xintercept = 1, linetype=""longdash"", colour=""#BE684D"", size=1) +"
"0","  geom_vline(xintercept = -1, linetype=""longdash"", colour=""#2C467A"", size=1) +"
"0","  labs(title=""sexual vs. asexual stages from bulk culture"","
"0","       subtitle = ""Volcano plot comparing expression of genes between sexual (24hr) and asexual stages (48hr) \nfrom bulk cultures of infected HCT-8 cells."") +"
"0","  theme_bw() + "
"0","  theme(axis.text=element_text(size=16),"
"0","        axis.title=element_text(size=18),"
"0","        plot.title = element_text(face=""bold""),"
"0","        panel.border = element_rect(colour = ""black"", fill=NA, size=1))"
