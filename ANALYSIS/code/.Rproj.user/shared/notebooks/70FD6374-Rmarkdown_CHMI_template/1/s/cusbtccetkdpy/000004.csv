"0","# running PCA"
"0","pca.res2 <- prcomp(t(log2.cpm.filtered.norm2), scale.=F, retx=T)"
"0","pc.var2<-pca.res2$sdev^2"
"0","pc.per2<-round(pc.var2/sum(pc.var2)*100, 1)"
"0","# converting PCA result into a tibble for plotting"
"0","pca.res.df2 <- as_tibble(pca.res2$x)"
"0","# plotting PCA"
"0","ggplot(pca.res.df2, aes(x=PC1, y=PC2, color=sex[13:21], shape=origin[13:21])) +"
"0","  geom_point(size=4) +"
"0","  theme(legend.position=""right"") + "
"0","  xlab(paste0(""PC1 ("",pc.per[1],""%"","")"")) + "
"0","  ylab(paste0(""PC2 ("",pc.per[2],""%"","")"")) + "
"0","  labs(title=""PCA of sporozoites vs in vitro timecourse"","
"0","       subtitle = ""Principal component analysis (PCA) showing separation \nbetween sporozoites and both asexual (24hr) and sexual (48hr) stages from bulk cultures"","
"0","       color = ""sex"", shape=""origin"") +"
"0","  theme_bw() + "
"0","  theme(plot.title = element_text(face=""bold""))"
